%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Arsclassica Article
% LaTeX Template
% Version 1.1 (10/6/14)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% Lorenzo Pantieri (http://www.lorenzopantieri.net) with extensive modifications by:
% Vel (vel@latextemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[
10pt, % Main document font size
a4paper, % Paper type, use 'letterpaper' for US Letter paper
oneside, % One page layout (no page indentation)
%twoside, % Two page layout (page indentation for binding and different headers)
headinclude,footinclude, % Extra spacing for the header and footer
BCOR5mm, % Binding correction
]{scrartcl}


\input{structure.tex} % Include the structure.tex file which specified the document structure and layout

\hyphenation{Fortran hy-phen-ation} % Specify custom hyphenation points in words with dashes where you would like hyphenation to occur, or alternatively, don't put any dashes in a word to stop hyphenation altogether

%----------------------------------------------------------------------------------------
%	TITLE AND AUTHOR(S)
%----------------------------------------------------------------------------------------

\title{\spacedallcaps{Distance Based Application Trigger}} % \spacedallcaps The article title

\author{\small{Mehdi Yosofie, Philipp Schlieker}} %   The article author(s) - author affiliations need to be specified in the AUTHOR AFFILIATIONS block

\date{\today} % An optional date to appear under the author(s)

%----------------------------------------------------------------------------------------

\begin{document}

%----------------------------------------------------------------------------------------
%	HEADERS
%----------------------------------------------------------------------------------------

\renewcommand{\sectionmark}[1]{\markright{\spacedlowsmallcaps{#1}}} % The header for all pages (oneside) or for even pages (twoside)
%\renewcommand{\subsectionmark}[1]{\markright{\thesubsection~#1}} % Uncomment when using the twoside option - this modifies the header on odd pages
\lehead{\mbox{\llap{\small\thepage\kern1em\color{halfgray} \vline}\color{halfgray}\hspace{0.5em}\rightmark\hfil}} % The header style

\pagestyle{scrheadings} % Enable the headers specified in this block

%----------------------------------------------------------------------------------------
%	TABLE OF CONTENTS & LISTS OF FIGURES AND TABLES
%----------------------------------------------------------------------------------------

\maketitle % Print the title/author/date block

\setcounter{tocdepth}{2} % Set the depth of the table of contents to show sections and subsections only

\tableofcontents % Print the table of contents

%\listoffigures % Print the list of figures

%\listoftables % Print the list of tables

%----------------------------------------------------------------------------------------
%	ABSTRACT
%----------------------------------------------------------------------------------------

\section*{Summary} % This section will not appear in the table of contents due to the star (\section*)

Context-awareness is an important issue in todays IoT world. Our project proposes a trigger that is activated based on the distance to a given object. In our scenario, we make us of the Bluetooth Low Energy (BLE) standard which allows the distance measurement between two objects. We use a BLE beacon together with the Bluetooth sensor of the smartphone in order to measure the distance. 


%----------------------------------------------------------------------------------------



%----------------------------------------------------------------------------------------
%	INTRODUCTION
%----------------------------------------------------------------------------------------

\section{Introduction}
The main idea of this project is to build an Android app that allows to trigger IoT devices based on position / distance thereby adding context-awareness. One standard way to do this, e.g. employed by IFTTT, is the use of GPS or the connectivity of WiFi networks. Both of these technologies allow for great radius but are quite limited in their accuracy. Thus, we propose to use Bluetooth Low Energy to estimate the distance. This is done by using a beacon that continously sends out a broadcast signal using Bluetooth. This signal is then received by a sensor which estimates the distance based on the signal strength. In our scenario we make us of a RaspberryPi as beacon and API. The sensor is then provided by an Android phone.


\section{Practical Applicability of the Project}
This type of project can be used in numerous scenarios. A few of which are the following:
\begin{enumerate}
\item 
	\begin{description}
	\item[Automatically Unlocking a door] Our prototype can be used to automatically unlock the front door of a house once the inhabitant arrives and thereby replacing the normal key. In contrast to WIFI the accuracy of BLE is high enough to \emph{only} keep the door unlocked while standing right next to it.
	\end{description}
	\item 
	\begin{description}
	\item[Switching Appliances] Another use case would be switching on and off appliances based on ones position in the room. One example would be a desk lamp which is switched on once the user is sitting at a desk and it is dark outside.
	\end{description}
	\item
	\begin{description}
	\item[Sensor for SmartHome Applications] Another use case is the use as a sensor for SmartHome Applications and thereby adding a wide range of possibilities. It is for example possible to switch on the light, adjust the room temperature and turn on music once a person enters a specific room.
	\end{description}
	\item
	\begin{description}
	\item[Preventing misuse of devices] Another option would be to prevent the misuse of devices by only allowing the invocation of a command when the person is in a specific location. This could be used by AirBnB to prevent guests from unlocking the front door when they are not there or by companies to enforce security policies.
	\end{description}
\end{enumerate}

\section{Conceptual Approach \& Architecture}


Our project architecture can be seen in figure \ref{fig:projectarchitecturefinal}. 

The used sensor is the Bluetooth sensor of an Android Smartphone. The Bluetooth Low Energy (BLE) Beacon is sending its signal constantly and periodically. The Smartphone (hold by a human) comes closer to the Beacon and detects the beacon. As soon as the beacon is detected by the smartphone (by the human), it sends (the human automatically sends) a HTTP request to our webserver to open the door/ to turn on the light. 

(We simulated the Beacon furthermore by a node.js application on PC. Thus, debugging and testing was faster and possible on every machine.)

The HTTP request arrives on the webserver (a Raspberry Pi). The Rasberry Pi handles the request by activating the lamp or opening a lock via its GPIO.

The Raspberry can be reached over a public IP adress. We used Balena as deployment architecture for the Raspberry Pi. Balena is a IoT cloud deployment platform where Balena images can be downloaded and flashed on the Raspberry. The image auto-pulls the code which the developer pushs on his git repository.
 
 
\begin{figure}[h]
	\centering
	\includegraphics[width=0.99\textwidth]{Project_Architecture_final1}
	\caption{Project Architecture}
	\label{fig:projectarchitecturefinal}
\end{figure}

\section{Sensors Used}
We used mainly the Bluetooth sensor of the Android phone. But furthermore the WiFi card both of the smartphone and Raspberry Pi are used. The GPIOs of Rasberry are used.

\begin{itemize}
\item Bluetooth sensor of Android phone
\end{itemize}


\section{Problems Faced}
Android implementation due to unknowness of Android development. We both had zero(!) Android experience.

\begin{enumerate}
\item 
	\begin{description}
	\item[Problem 1] Using the Bluetooth library on Android. Solution was to deal with it very long time.
	\end{description}
	\item 
	\begin{description}
	\item[Problem 2] Running Bluetooth scanning in background on Android. Was difficult on our Android 8 application. Adding an persistent Android notification solved that issue.
	\end{description}
\end{enumerate}

\section{Work Items}
Enumerate the exact work-items which you have worked on. 
\begin{enumerate}
\item 
	\begin{description}
	\item[Task 1] Add LocalTunnel for remote Endpoint
	\end{description}
	\item 
	\begin{description}
		\item[Task 2] Building API on RaspberryPi
	\end{description}
	\item 
	\begin{description}
		\item[Task 3] Calling API on Android
	\end{description}
	\item 
	\begin{description}
		\item[Task 4] Background Bluetooth Scanning on Android even if application is not actively open in foreground
	\end{description}
	\item 
	\begin{description}
		\item[Task 5] Create Settings Page in Android app
	\end{description}
	\item 
	\begin{description}
		\item[Task 5] Testing everything. We used the feature branch system of Git: implementing and pushing, the other tests and merges into main branch.
	\end{description}
	\item 
	\begin{description}
		\item[Task 6] Simulate Beacon on computer if BLE fails due to leck of battery level and debugging and testing on different machines
	\end{description}
\end{enumerate}

\section{Work Split}
Who did what with respect to the above list of tasks?

\section{Concluding Remarks}
Your concluding remarks!

%----------------------------------------------------------------------------------------
%	BIBLIOGRAPHY
%----------------------------------------------------------------------------------------

\renewcommand{\refname}{\spacedlowsmallcaps{References}} % For modifying the bibliography heading

\bibliographystyle{unsrt}

\bibliography{references.bib} % The file containing the bibliography

%----------------------------------------------------------------------------------------

\end{document}